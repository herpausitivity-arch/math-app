<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Master Pro</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #059669 0%, #10b981 50%, #14b8a6 100%);
            min-height: 100vh;
        }
        
        .header {
            background: rgba(22, 101, 52, 0.3);
            backdrop-filter: blur(10px);
            padding: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header-content { max-width: 1200px; margin: 0 auto; }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .title { color: white; font-size: 1.5rem; font-weight: bold; }
        .stats { display: flex; gap: 1.5rem; color: white; font-weight: bold; }
        .stat-item { display: flex; align-items: center; gap: 0.5rem; }
        
        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }
        
        .nav-tab {
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .nav-tab.active {
            background: white;
            color: #059669;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .nav-tab:not(.active) {
            background: rgba(255,255,255,0.2);
            color: white;
        }
        
        .nav-tab:not(.active):hover { background: rgba(255,255,255,0.3); }
        .container { max-width: 1200px; margin: 0 auto; padding: 1rem; }
        
        .card {
            background: white;
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 1rem;
        }
        
        .card-title {
            color: #059669;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .problem-box {
            background: linear-gradient(135deg, #f0fdf4 0%, #d1fae5 100%);
            border-radius: 1rem;
            padding: 2rem;
            margin: 1.5rem 0;
            text-align: center;
        }
        
        .problem-text {
            font-size: 2.5rem;
            font-weight: bold;
            color: #064e3b;
            margin-bottom: 1rem;
            font-family: 'Courier New', monospace;
        }
        
        .input-group {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }
        
        .math-input {
            width: 140px;
            padding: 0.75rem;
            font-size: 1.5rem;
            text-align: center;
            border: 3px solid #6ee7b7;
            border-radius: 0.75rem;
            font-family: 'Courier New', monospace;
        }
        
        .math-input:focus {
            outline: none;
            border-color: #059669;
            box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.1);
        }
        
        .times-symbol { font-size: 2rem; color: #059669; font-weight: bold; }
        
        .btn {
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0,0,0,0.15);
        }
        
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-primary { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; }
        .btn-warning { background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: white; }
        .btn-secondary { background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%); color: white; }
        .btn-blue { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; }
        
        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 1.5rem;
        }
        
        .feedback {
            padding: 1.5rem;
            border-radius: 1rem;
            text-align: center;
            margin: 1rem 0;
            font-weight: bold;
            font-size: 1.25rem;
            animation: slideIn 0.3s ease-out;
        }
        
        .feedback.success { background: #d1fae5; border: 3px solid #6ee7b7; color: #065f46; }
        .feedback.error { background: #fee2e2; border: 3px solid #fca5a5; color: #991b1b; }
        
        .hint-box {
            background: #fef3c7;
            border: 3px solid #fbbf24;
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 1rem 0;
            animation: slideIn 0.3s ease-out;
        }
        
        .hint-title { color: #92400e; font-weight: bold; margin-bottom: 0.5rem; font-size: 1.1rem; }
        .hint-text { color: #78350f; line-height: 1.6; }
        
        .level-buttons {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 1.5rem;
        }
        
        .level-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.75rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .level-btn.active { background: #059669; color: white; }
        .level-btn:not(.active) { background: #e5e7eb; color: #374151; }
        
        .homework-form {
            background: linear-gradient(135deg, #f0fdf4 0%, #d1fae5 100%);
            border: 2px solid #6ee7b7;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .form-group { margin-bottom: 1rem; }
        .form-label { display: block; font-weight: bold; margin-bottom: 0.5rem; color: #064e3b; }
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #6ee7b7;
            border-radius: 0.5rem;
            font-size: 1rem;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #059669;
        }
        
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        
        .homework-item { border: 2px solid; border-radius: 1rem; padding: 1.5rem; margin-bottom: 1rem; }
        .homework-item.due-soon { background: #fef3c7; border-color: #fbbf24; }
        .homework-item.overdue { background: #fee2e2; border-color: #f87171; }
        .homework-item.normal { background: #f0fdf4; border-color: #6ee7b7; }
        
        .homework-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.75rem;
        }
        
        .homework-title { font-size: 1.5rem; font-weight: bold; color: #064e3b; }
        .subject-badge {
            background: #059669;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            font-weight: bold;
        }
        
        .homework-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
            flex-wrap: wrap;
            font-weight: 600;
        }
        
        .delete-btn {
            background: #dc2626;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: bold;
        }
        
        .delete-btn:hover { background: #b91c1c; }
        .homework-image {
            max-width: 100%;
            border-radius: 0.5rem;
            border: 2px solid #6ee7b7;
            margin-top: 0.5rem;
        }
        
        .empty-state { text-align: center; padding: 3rem; color: #6b7280; }
        .empty-icon { font-size: 4rem; margin-bottom: 1rem; opacity: 0.5; }
        .hidden { display: none; }
        
        .info-box {
            background: #dbeafe;
            border: 2px solid #60a5fa;
            border-radius: 1rem;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .info-title { color: #1e40af; font-weight: bold; margin-bottom: 0.5rem; }
        .info-text { color: #1e3a8a; }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 640px) {
            .title { font-size: 1.25rem; }
            .problem-text { font-size: 1.75rem; }
            .math-input { width: 120px; font-size: 1.25rem; }
            .form-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="header-top">
                <div class="title">üìö Math Master Pro</div>
                <div class="stats">
                    <div class="stat-item">üèÜ <span id="score">0</span></div>
                    <div class="stat-item">‚≠ê <span id="streak">0</span> üî•</div>
                    <div class="stat-item">üéØ Lvl <span id="level">1</span></div>
                </div>
            </div>
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('home')">üè† Home</button>
                <button class="nav-tab" onclick="showSection('trinomial')">üî¢ Trinomials</button>
                <button class="nav-tab" onclick="showSection('quadratic')">üìê Quadratic</button>
                <button class="nav-tab" onclick="showSection('parabola')">üìä Parabolas</button>
                <button class="nav-tab" onclick="showSection('geometry')">üî∫ Geometry</button>
                <button class="nav-tab" onclick="showSection('homework')">üìö Homework</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Home Section -->
        <div id="home-section" class="section">
            <div class="card">
                <h2 class="card-title">Welcome! üéì</h2>
                <p style="text-align: center; font-size: 1.25rem; color: #4b5563; margin-bottom: 2rem;">
                    Your complete 8th grade math learning companion!
                </p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div style="background: linear-gradient(135deg, #f0fdf4 0%, #d1fae5 100%); padding: 1.5rem; border-radius: 1rem; border: 2px solid #6ee7b7;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üî¢</div>
                        <h3 style="color: #065f46; font-weight: bold; margin-bottom: 0.5rem;">Trinomials</h3>
                        <p style="color: #064e3b;">Factor trinomials with step-by-step hints</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); padding: 1.5rem; border-radius: 1rem; border: 2px solid #60a5fa;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìê</div>
                        <h3 style="color: #1e40af; font-weight: bold; margin-bottom: 0.5rem;">Quadratic</h3>
                        <p style="color: #1e3a8a;">Solve using the quadratic formula</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #e9d5ff 0%, #d8b4fe 100%); padding: 1.5rem; border-radius: 1rem; border: 2px solid #c084fc;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìä</div>
                        <h3 style="color: #6b21a8; font-weight: bold; margin-bottom: 0.5rem;">Parabolas</h3>
                        <p style="color: #581c87;">Find vertex & axis of symmetry</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%); padding: 1.5rem; border-radius: 1rem; border: 2px solid #fb923c;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üî∫</div>
                        <h3 style="color: #9a3412; font-weight: bold; margin-bottom: 0.5rem;">Geometry</h3>
                        <p style="color: #7c2d12;">Area, perimeter & angles</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 1.5rem; border-radius: 1rem; border: 2px solid #fbbf24;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìö</div>
                        <h3 style="color: #78350f; font-weight: bold; margin-bottom: 0.5rem;">Homework</h3>
                        <p style="color: #92400e;">Track with photos & reminders</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trinomial Section -->
        <div id="trinomial-section" class="section hidden">
            <div class="card">
                <h2 class="card-title">Factor the Trinomial</h2>
                
                <div class="level-buttons">
                    <button class="level-btn active" onclick="setLevel(1)">Easy</button>
                    <button class="level-btn" onclick="setLevel(2)">Medium</button>
                    <button class="level-btn" onclick="setLevel(3)">Hard</button>
                </div>

                <div class="problem-box">
                    <div class="problem-text" id="trinomial-display">x¬≤ + 5x + 6</div>
                    <div style="font-size: 1.5rem; margin: 1rem 0;">=</div>
                    <div class="input-group">
                        <input type="text" class="math-input" id="tri-factor1" placeholder="(x ¬± ?)">
                        <span class="times-symbol">√ó</span>
                        <input type="text" class="math-input" id="tri-factor2" placeholder="(x ¬± ?)">
                    </div>
                </div>

                <div id="tri-feedback"></div>
                <div id="tri-hint"></div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="checkTrinomial()">Check Answer</button>
                    <button class="btn btn-warning" onclick="toggleTrinomialHint()">Show Hint</button>
                    <button class="btn btn-secondary" onclick="generateTrinomial()">New Problem</button>
                </div>
            </div>
        </div>

        <!-- Quadratic Formula Section -->
        <div id="quadratic-section" class="section hidden">
            <div class="card">
                <h2 class="card-title">Quadratic Formula</h2>
                
                <div class="info-box">
                    <div class="info-title">Formula:</div>
                    <div style="text-align: center; font-size: 1.5rem; font-family: 'Courier New', monospace; color: #1e40af; margin-top: 0.5rem;">
                        x = (-b ¬± ‚àö(b¬≤ - 4ac)) / 2a
                    </div>
                </div>

                <div class="problem-box">
                    <div class="problem-text" id="quad-display">2x¬≤ + 3x - 2 = 0</div>
                    <div style="font-size: 1.25rem; margin: 1rem 0;">Find the values of x (round to 2 decimals):</div>
                    <div class="input-group">
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">x‚ÇÅ =</label>
                            <input type="number" step="0.01" class="math-input" id="quad-x1" style="width: 160px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">x‚ÇÇ =</label>
                            <input type="number" step="0.01" class="math-input" id="quad-x2" style="width: 160px;">
                        </div>
                    </div>
                </div>

                <div id="quad-feedback"></div>
                <div id="quad-steps"></div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="checkQuadratic()">Check Answer</button>
                    <button class="btn btn-blue" onclick="toggleQuadSteps()">Show Steps</button>
                    <button class="btn btn-secondary" onclick="generateQuadratic()">New Problem</button>
                </div>
            </div>
        </div>

        <!-- Parabola Section -->
        <div id="parabola-section" class="section hidden">
            <div class="card">
                <h2 class="card-title">Parabolas - Vertex Form</h2>

                <div class="problem-box">
                    <div class="problem-text" id="para-display">y = 2(x - 3)¬≤ + 4</div>
                    <div style="margin-top: 2rem;">
                        <div style="margin-bottom: 1.5rem;">
                            <label style="display: block; font-size: 1.25rem; font-weight: bold; margin-bottom: 0.5rem;">Vertex (h, k):</label>
                            <input type="text" class="math-input" id="para-vertex" placeholder="(h, k)" style="width: 200px;">
                        </div>
                        <div>
                            <label style="display: block; font-size: 1.25rem; font-weight: bold; margin-bottom: 0.5rem;">Axis of Symmetry:</label>
                            <input type="text" class="math-input" id="para-axis" placeholder="x = ?" style="width: 200px;">
                        </div>
                    </div>
                </div>

                <div id="para-feedback"></div>

                <div class="info-box">
                    <div class="info-title">Remember:</div>
                    <ul style="color: #1e3a8a; margin-left: 1.5rem; line-height: 1.8;">
                        <li>Vertex form: y = a(x - h)¬≤ + k</li>
                        <li>Vertex is at point (h, k)</li>
                        <li>Axis of symmetry is x = h</li>
                    </ul>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="checkParabola()">Check Answer</button>
                    <button class="btn btn-secondary" onclick="generateParabola()">New Problem</button>
                </div>
            </div>
        </div>

        <!-- Geometry Section -->
        <div id="geometry-section" class="section hidden">
            <div class="card">
                <h2 class="card-title">Geometry Practice</h2>

                <div class="problem-box">
                    <div style="font-size: 1.5rem; color: #064e3b; margin-bottom: 2rem;" id="geo-question">Find the area of a triangle with base 6 and height 8</div>
                    <div>
                        <label style="display: block; font-size: 1.25rem; font-weight: bold; margin-bottom: 0.5rem;">Your Answer:</label>
                        <input type="number" step="0.01" class="math-input" id="geo-answer" placeholder="Answer" style="width: 200px;">
                    </div>
                </div>

                <div id="geo-feedback"></div>

                <div class="info-box">
                    <div class="info-title">Formulas:</div>
                    <ul style="color: #1e3a8a; margin-left: 1.5rem; line-height: 1.8;">
                        <li>Triangle Area = ¬Ω √ó base √ó height</li>
                        <li>Rectangle Perimeter = 2 √ó (length + width)</li>
                        <li>Circle Area = œÄ √ó radius¬≤ (use œÄ ‚âà 3.14)</li>
                        <li>Triangle angles sum to 180¬∞</li>
                    </ul>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="checkGeometry()">Check Answer</button>
                    <button class="btn btn-secondary" onclick="generateGeometry()">New Problem</button>
                </div>
            </div>
        </div>

        <!-- Homework Section -->
        <div id="homework-section" class="section hidden">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;">
                    <h2 class="card-title" style="margin: 0;">Homework Tracker üìö</h2>
                    <button class="btn btn-primary" onclick="toggleHomeworkForm()">+ Add Homework</button>
                </div>

                <div id="homework-form" class="homework-form hidden">
                    <h3 style="color: #065f46; margin-bottom: 1rem; font-weight: bold;">New Assignment</h3>
                    <div class="form-group">
                        <label class="form-label">Title *</label>
                        <input type="text" class="form-input" id="hw-title" placeholder="e.g., Math Worksheet Ch. 5">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Subject</label>
                            <select class="form-select" id="hw-subject">
                                <option value="">Select...</option>
                                <option value="Math">Math</option>
                                <option value="Science">Science</option>
                                <option value="English">English</option>
                                <option value="History">History</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Due Date *</label>
                            <input type="date" class="form-input" id="hw-date">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Notes</label>
                        <textarea class="form-textarea" id="hw-notes" rows="2" placeholder="Add notes..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">üì∑ Upload Photo</label>
                        <input type="file" accept="image/*" capture="environment" id="hw-photo" onchange="previewImage()" style="padding: 0.5rem;">
                        <div id="image-preview"></div>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-primary" onclick="saveHomework()">Save</button>
                        <button class="btn btn-secondary" onclick="toggleHomeworkForm()">Cancel</button>
                    </div>
                </div>

                <div id="homework-list"></div>
            </div>
        </div>
    </div>

    <script>
        // State
        let score = 0;
        let streak = 0;
        let level = 1;
        let trinomialProblem = null;
        let quadraticProblem = null;
        let parabolaProblem = null;
        let geometryProblem = null;
        let showingTriHint = false;
        let showingQuadSteps = false;
        let triHintStep = 1;
        let homeworkItems = JSON.parse(localStorage.getItem('homework') || '[]');
        let currentImageData = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            generateTrinomial();
            generateQuadratic();
            generateParabola();
            generateGeometry();
            renderHomework();
        });

        // Navigation
        function showSection(section) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById(section + '-section').classList.remove('hidden');
            event.target.classList.add('active');
        }

        // Trinomial Logic
        function setLevel(newLevel) {
            level = newLevel;
            document.getElementById('level').textContent = level;
            document.querySelectorAll('.level-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i + 1 === level);
            });
            generateTrinomial();
        }

        function generateTrinomial() {
            let a, b, c, root1, root2;
            
            if (level === 1) {
                root1 = Math.floor(Math.random() * 6) + 1;
                root2 = Math.floor(Math.random() * 6) + 1;
                const choice = Math.random();
                if (choice < 0.33) {
                } else if (choice < 0.66) {
                    root1 = -root1;
                } else {
                    root1 = -root1;
                    root2 = -root2;
                }
                a = 1;
            } else {
                root1 = Math.floor(Math.random() * 8) + 1;
                root2 = Math.floor(Math.random() * 8) + 1;
                const choice = Math.random();
                if (choice < 0.25) {
                } else if (choice < 0.5) {
                    root1 = -root1;
                } else if (choice < 0.75) {
                    root2 = -root2;
                } else {
                    root1 = -root1;
                    root2 = -root2;
                }
                a = 1;
            }
            
            b = -(root1 + root2);
            c = root1 * root2;
            
            trinomialProblem = { a, b, c, roots: [root1, root2] };
            
            let display = '';
            if (a === 1) display = 'x¬≤';
            else display = a + 'x¬≤';
            
            if (b > 0) display += ' + ' + (b === 1 ? '' : b) + 'x';
            else if (b < 0) display += ' - ' + (Math.abs(b) === 1 ? '' : Math.abs(b)) + 'x';
            
            if (c > 0) display += ' + ' + c;
            else if (c < 0) display += ' - ' + Math.abs(c);
            
            document.getElementById('trinomial-display').textContent = display;
            document.getElementById('tri-factor1').value = '';
            document.getElementById('tri-factor2').value = '';
            document.getElementById('tri-feedback').innerHTML = '';
            document.getElementById('tri-hint').innerHTML = '';
            showingTriHint = false;
            triHintStep = 1;
        }

        function checkTrinomial() {
            const ans1 = document.getElementById('tri-factor1').value.toLowerCase().replace(/\s/g, '');
            const ans2 = document.getElementById('tri-factor2').value.toLowerCase().replace(/\s/g, '');
            
            const correct1 = `(x${trinomialProblem.roots[0] >= 0 ? '-' : '+'}${Math.abs(trinomialProblem.roots[0])})`;
            const correct2 = `(x${trinomialProblem.roots[1] >= 0 ? '-' : '+'}${Math.abs(trinomialProblem.roots[1])})`;
            
            const isCorrect = 
                (ans1 === correct1 && ans2 === correct2) ||
                (ans1 === correct2 && ans2 === correct1);
            
            const feedbackBox = document.getElementById('tri-feedback');
            
            if (isCorrect) {
                const points = (level * 10) + (streak * 5);
                score += points;
                streak++;
                document.getElementById('score').textContent = score;
                document.getElementById('streak').textContent = streak;
                
                feedbackBox.innerHTML = `
                    <div class="feedback success">
                        ‚úÖ Outstanding! üåü
                        <div style="font-size: 1rem; margin-top: 0.5rem;">+${points} points!</div>
                    </div>
                `;
                
                setTimeout(generateTrinomial, 2500);
            } else {
                streak = 0;
                document.getElementById('streak').textContent = streak;
                feedbackBox.innerHTML = `
                    <div class="feedback error">
                        ‚ùå Not quite! Try again or use a hint.
                    </div>
                `;
            }
        }

        function toggleTrinomialHint() {
            showingTriHint = !showingTriHint;
            const hintBox = document.getElementById('tri-hint');
            
            if (!showingTriHint) {
                hintBox.innerHTML = '';
                return;
            }
            
            let hintText = '';
            if (triHintStep === 1) {
                hintText = `Find two numbers that multiply to ${trinomialProblem.c} and add to ${trinomialProblem.b}.`;
            } else if (triHintStep === 2) {
                hintText = `The numbers are ${trinomialProblem.roots[0]} and ${trinomialProblem.roots[1]}.`;
            } else {
                hintText = `Answer: (x ${trinomialProblem.roots[0] >= 0 ? '-' : '+'}${Math.abs(trinomialProblem.roots[0])})(x ${trinomialProblem.roots[1] >= 0 ? '-' : '+'}${Math.abs(trinomialProblem.roots[1])})`;
            }
            
            hintBox.innerHTML = `
                <div class="hint-box">
                    <div class="hint-title">üí° Hint (Step ${triHintStep}/3):</div>
                    <div class="hint-text">${hintText}</div>
                    ${triHintStep < 3 ? '<button class="btn btn-warning" style="margin-top: 1rem;" onclick="nextTriHint()">Next Step</button>' : ''}
                </div>
            `;
        }

        function nextTriHint() {
            triHintStep = Math.min(triHintStep + 1, 3);
            toggleTrinomialHint();
            showingTriHint = true;
        }

        // Quadratic Formula Logic
        function generateQuadratic() {
            let a, b, c, discriminant, x1, x2;
            
            do {
                a = Math.floor(Math.random() * 3) + 1;
                b = Math.floor(Math.random() * 10) - 5;
                c = Math.floor(Math.random() * 10) - 5;
                discriminant = b * b - 4 * a * c;
            } while (discriminant < 0);
            
            x1 = (-b + Math.sqrt(discriminant)) / (2 * a);
            x2 = (-b - Math.sqrt(discriminant)) / (2 * a);
            
            quadraticProblem = { a, b, c, discriminant, x1, x2 };
            
            let display = `${a}x¬≤`;
            if (b >= 0) display += ` + ${b}x`;
            else display += ` - ${Math.abs(b)}x`;
            if (c >= 0) display += ` + ${c}`;
            else display += ` - ${Math.abs(c)}`;
            display += ' = 0';
            
            document.getElementById('quad-display').textContent = display;
            document.getElementById('quad-x1').value = '';
            document.getElementById('quad-x2').value = '';
            document.getElementById('quad-feedback').innerHTML = '';
            document.getElementById('quad-steps').innerHTML = '';
            showingQuadSteps = false;
        }

        function checkQuadratic() {
            const ans1 = parseFloat(document.getElementById('quad-x1').value);
            const ans2 = parseFloat(document.getElementById('quad-x2').value);
            
            if (isNaN(ans1) || isNaN(ans2)) {
                document.getElementById('quad-feedback').innerHTML = `
                    <div class="feedback error">Please enter valid numbers</div>
                `;
                return;
            }
            
            const isCorrect = 
                (Math.abs(ans1 - quadraticProblem.x1) < 0.1 && Math.abs(ans2 - quadraticProblem.x2) < 0.1) ||
                (Math.abs(ans1 - quadraticProblem.x2) < 0.1 && Math.abs(ans2 - quadraticProblem.x1) < 0.1);
            
            if (isCorrect) {
                const points = 20 + (streak * 5);
                score += points;
                streak++;
                document.getElementById('score').textContent = score;
                document.getElementById('streak').textContent = streak;
                
                document.getElementById('quad-feedback').innerHTML = `
                    <div class="feedback success">
                        ‚úÖ Perfect! üéØ
                        <div style="font-size: 1rem; margin-top: 0.5rem;">+${points} points!</div>
                    </div>
                `;
                
                setTimeout(generateQuadratic, 2500);
            } else {
                streak = 0;
                document.getElementById('streak').textContent = streak;
                document.getElementById('quad-feedback').innerHTML = `
                    <div class="feedback error">‚ùå Not quite! Check your calculation.</div>
                `;
            }
        }

        function toggleQuadSteps() {
            showingQuadSteps = !showingQuadSteps;
            const stepsBox = document.getElementById('quad-steps');
            
            if (!showingQuadSteps) {
                stepsBox.innerHTML = '';
                return;
            }
            
            stepsBox.innerHTML = `
                <div class="hint-box">
                    <div class="hint-title">Step-by-Step Solution:</div>
                    <div class="hint-text" style="font-family: 'Courier New', monospace;">
                        <p>1. a = ${quadraticProblem.a}, b = ${quadraticProblem.b}, c = ${quadraticProblem.c}</p>
                        <p>2. b¬≤ - 4ac = ${quadraticProblem.b}¬≤ - 4(${quadraticProblem.a})(${quadraticProblem.c}) = ${quadraticProblem.discriminant.toFixed(2)}</p>
                        <p>3. x = (-${quadraticProblem.b} ¬± ‚àö${quadraticProblem.discriminant.toFixed(2)}) / ${2 * quadraticProblem.a}</p>
                        <p>4. x‚ÇÅ = ${quadraticProblem.x1.toFixed(2)}, x‚ÇÇ = ${quadraticProblem.x2.toFixed(2)}</p>
                    </div>
                </div>
            `;
        }

        // Parabola Logic
        function generateParabola() {
            const a = Math.floor(Math.random() * 5) + 1;
            const h = Math.floor(Math.random() * 10) - 5;
            const k = Math.floor(Math.random() * 10) - 5;
            
            parabolaProblem = { a, h, k };
            
            const display = `y = ${a}(x ${h >= 0 ? '-' : '+'} ${Math.abs(h)})¬≤ ${k >= 0 ? '+' : ''}${k}`;
            
            document.getElementById('para-display').textContent = display;
            document.getElementById('para-vertex').value = '';
            document.getElementById('para-axis').value = '';
            document.getElementById('para-feedback').innerHTML = '';
        }

        function checkParabola() {
            const vertexAns = document.getElementById('para-vertex').value.toLowerCase().replace(/\s/g, '');
            const axisAns = document.getElementById('para-axis').value.toLowerCase().replace(/\s/g, '');
            
            const correctVertex = `(${parabolaProblem.h},${parabolaProblem.k})`;
            const correctAxis = `x=${parabolaProblem.h}`;
            
            const isCorrect = vertexAns === correctVertex && axisAns === correctAxis;
            
            if (isCorrect) {
                const points = 15 + (streak * 5);
                score += points;
                streak++;
                document.getElementById('score').textContent = score;
                document.getElementById('streak').textContent = streak;
                
                document.getElementById('para-feedback').innerHTML = `
                    <div class="feedback success">
                        ‚úÖ Excellent! üìä
                        <div style="font-size: 1rem; margin-top: 0.5rem;">+${points} points!</div>
                    </div>
                `;
                
                setTimeout(generateParabola, 2500);
            } else {
                streak = 0;
                document.getElementById('streak').textContent = streak;
                document.getElementById('para-feedback').innerHTML = `
                    <div class="feedback error">‚ùå Not quite! Try again.</div>
                `;
            }
        }

        // Geometry Logic
        function generateGeometry() {
            const types = [
                { type: 'triangle-area', question: (b, h) => `Find the area of a triangle with base ${b} and height ${h}`, answer: (b, h) => (b * h) / 2 },
                { type: 'rectangle-perimeter', question: (l, w) => `Find the perimeter of a rectangle with length ${l} and width ${w}`, answer: (l, w) => 2 * (l + w) },
                { type: 'circle-area', question: (r) => `Find the area of a circle with radius ${r} (use œÄ ‚âà 3.14)`, answer: (r) => 3.14 * r * r },
                { type: 'angle-sum', question: (a1, a2) => `In a triangle, two angles measure ${a1}¬∞ and ${a2}¬∞. Find the third angle.`, answer: (a1, a2) => 180 - a1 - a2 }
            ];
            
            const selectedType = types[Math.floor(Math.random() * types.length)];
            
            let question, answer;
            if (selectedType.type === 'triangle-area') {
                const base = Math.floor(Math.random() * 10) + 2;
                const height = Math.floor(Math.random() * 10) + 2;
                question = selectedType.question(base, height);
                answer = selectedType.answer(base, height);
            } else if (selectedType.type === 'rectangle-perimeter') {
                const length = Math.floor(Math.random() * 10) + 2;
                const width = Math.floor(Math.random() * 10) + 2;
                question = selectedType.question(length, width);
                answer = selectedType.answer(length, width);
            } else if (selectedType.type === 'circle-area') {
                const radius = Math.floor(Math.random() * 5) + 2;
                question = selectedType.question(radius);
                answer = selectedType.answer(radius);
            } else {
                const angle1 = Math.floor(Math.random() * 80) + 20;
                const angle2 = Math.floor(Math.random() * 80) + 20;
                question = selectedType.question(angle1, angle2);
                answer = selectedType.answer(angle1, angle2);
            }
            
            geometryProblem = { question, answer };
            
            document.getElementById('geo-question').textContent = question;
            document.getElementById('geo-answer').value = '';
            document.getElementById('geo-feedback').innerHTML = '';
        }

        function checkGeometry() {
            const ans = parseFloat(document.getElementById('geo-answer').value);
            
            if (isNaN(ans)) {
                document.getElementById('geo-feedback').innerHTML = `
                    <div class="feedback error">Please enter a valid number</div>
                `;
                return;
            }
            
            const isCorrect = Math.abs(ans - geometryProblem.answer) < 1;
            
            if (isCorrect) {
                const points = 15 + (streak * 5);
                score += points;
                streak++;
                document.getElementById('score').textContent = score;
                document.getElementById('streak').textContent = streak;
                
                document.getElementById('geo-feedback').innerHTML = `
                    <div class="feedback success">
                        ‚úÖ Great work! üìê
                        <div style="font-size: 1rem; margin-top: 0.5rem;">+${points} points!</div>
                    </div>
                `;
                
                setTimeout(generateGeometry, 2500);
            } else {
                streak = 0;
                document.getElementById('streak').textContent = streak;
                document.getElementById('geo-feedback').innerHTML = `
                    <div class="feedback error">‚ùå Not quite! Try again.</div>
                `;
            }
        }

        // Homework Logic
        function toggleHomeworkForm() {
            const form = document.getElementById('homework-form');
            form.classList.toggle('hidden');
            if (!form.classList.contains('hidden')) {
                document.getElementById('hw-title').value = '';
                document.getElementById('hw-subject').value = '';
                document.getElementById('hw-date').value = '';
                document.getElementById('hw-notes').value = '';
                document.getElementById('hw-photo').value = '';
                document.getElementById('image-preview').innerHTML = '';
                currentImageData = null;
            }
        }

        function previewImage() {
            const file = document.getElementById('hw-photo').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentImageData = e.target.result;
                    document.getElementById('image-preview').innerHTML = `
                        <img src="${e.target.result}" style="max-width: 100%; margin-top: 1rem; border-radius: 0.5rem; border: 2px solid #6ee7b7;">
                    `;
                };
                reader.readAsDataURL(file);
            }
        }

        function saveHomework() {
            const title = document.getElementById('hw-title').value;
            const date = document.getElementById('hw-date').value;
            
            if (!title || !date) {
                alert('Please fill in title and due date');
                return;
            }
            
            const homework = {
                id: Date.now(),
                title: title,
                subject: document.getElementById('hw-subject').value,
                dueDate: date,
                notes: document.getElementById('hw-notes').value,
                image: currentImageData
            };
            
            homeworkItems.push(homework);
            localStorage.setItem('homework', JSON.stringify(homeworkItems));
            toggleHomeworkForm();
            renderHomework();
        }

        function deleteHomework(id) {
            if (confirm('Delete this homework?')) {
                homeworkItems = homeworkItems.filter(item => item.id !== id);
                localStorage.setItem('homework', JSON.stringify(homeworkItems));
                renderHomework();
            }
        }

        function renderHomework() {
            const list = document.getElementById('homework-list');
            
            if (homeworkItems.length === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìö</div>
                        <div style="font-size: 1.25rem;">No homework yet. Click "Add Homework" to start!</div>
                    </div>
                `;
                return;
            }
            
            list.innerHTML = homeworkItems.map(item => {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const due = new Date(item.dueDate);
                due.setHours(0, 0, 0, 0);
                const diffDays = Math.ceil((due - today) / (1000 * 60 * 60 * 24));
                
                const isOverdue = diffDays < 0;
                const isDueSoon = diffDays >= 0 && diffDays <= 2;
                const className = isOverdue ? 'overdue' : isDueSoon ? 'due-soon' : 'normal';
                
                const daysText = isOverdue ? `${Math.abs(diffDays)}d overdue!` : 
                                diffDays === 0 ? 'Due today!' : 
                                `${diffDays}d left`;
                
                return `
                    <div class="homework-item ${className}">
                        <div class="homework-header">
                            <div>
                                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; flex-wrap: wrap;">
                                    <div class="homework-title">${item.title}</div>
                                    ${item.subject ? `<span class="subject-badge">${item.subject}</span>` : ''}
                                </div>
                                <div class="homework-meta">
                                    <span>üìÖ ${new Date(item.dueDate).toLocaleDateString()}</span>
                                    <span>‚è∞ ${daysText}</span>
                                </div>
                                ${item.notes ? `<div style="color: #374151; margin-top: 0.5rem;">${item.notes}</div>` : ''}
                                ${item.image ? `<img src="${item.image}" class="homework-image">` : ''}
                            </div>
                            <button class="delete-btn" onclick="deleteHomework(${item.id})">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');
        }
    </script>
</body>
</html>